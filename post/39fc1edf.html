<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>Effective Java（一）创建和销毁对象 - J.e</title>


    <meta name="description" content="《Effective Java》这本书算得上有口皆碑了，去年发现出了第三版，趁某东活动入手了一本英文版，粗略了过了一下，这本书给我最大的体会就是它教你如何成为一个真正的 Java 程序员，而不是 CRUD 程序员或 Spring 程序员，读这本书，能让你站在更高的角度和更深层次的视角去剖析 Java 的细节，让人豁然开朗。然而，上半年因为各种原因，瞎忙活了大半年，这本书一直没机会捡起来仔细看。好在">
<meta property="og:type" content="article">
<meta property="og:title" content="Effective Java（一）创建和销毁对象">
<meta property="og:url" content="https://jerrysheh.me/post/39fc1edf.html">
<meta property="og:site_name" content="J.e">
<meta property="og:description" content="《Effective Java》这本书算得上有口皆碑了，去年发现出了第三版，趁某东活动入手了一本英文版，粗略了过了一下，这本书给我最大的体会就是它教你如何成为一个真正的 Java 程序员，而不是 CRUD 程序员或 Spring 程序员，读这本书，能让你站在更高的角度和更深层次的视角去剖析 Java 的细节，让人豁然开朗。然而，上半年因为各种原因，瞎忙活了大半年，这本书一直没机会捡起来仔细看。好在">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jerrysheh.me/images/og_image.png">
<meta property="article:published_time" content="2019-09-09T15:35:58.000Z">
<meta property="article:modified_time" content="2019-12-29T12:15:10.582Z">
<meta property="article:author" content="Jerry Sheh">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jerrysheh.me/images/og_image.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="Effective Java（一）创建和销毁对象" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/">首页</a>
                
                <a class="navbar-item"
                href="/archives">时间线</a>
                
                <a class="navbar-item"
                href="/categories">文章分类</a>
                
                <a class="navbar-item"
                href="/about">关于</a>
                
                <a class="navbar-item"
                href="/anpu">Anpu</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>

    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-09-09T15:35:58.000Z">2019-09-09</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Effective-Java/">Effective Java</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    24 分钟 读完 (大约 3606 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                Effective Java（一）创建和销毁对象
            
        </h1>
        <div class="content">
            <p>《Effective Java》这本书算得上有口皆碑了，去年发现出了第三版，趁某东活动入手了一本英文版，粗略了过了一下，这本书给我最大的体会就是它教你如何成为一个真正的 Java 程序员，而不是 CRUD 程序员或 Spring 程序员，读这本书，能让你站在更高的角度和更深层次的视角去剖析 Java 的细节，让人豁然开朗。然而，上半年因为各种原因，瞎忙活了大半年，这本书一直没机会捡起来仔细看。好在最近工作不忙，想起来有这本书，决定一天看两个 Item 。</p>
<p>系列目录：</p>
<ul>
<li><a href="../post/39fc1edf.html">Effective Java（一）创建和销毁对象</a></li>
<li><a href="../post/f754c291.html">Effective Java（二）对象通用的方法</a></li>
<li><a href="../post/20ef17da.html">Effective Java（三）类和接口</a></li>
<li><a href="../post/53a4cf82.html">Effective Java（四）泛型</a></li>
<li><a href="../post/acf36022.html">Effective Java（五）枚举和注解</a></li>
<li><a href="../post/cc85a16e.html">Effective Java（六）Lambdas and Streams</a></li>
<li><a href="../post/387fb533.html">Effective Java（七）方法</a></li>
<li><a href="../post/7d5810ff.html">Effective Java（八）General Programming</a></li>
<li><a href="../post/4e34dae4.html">Effective Java（九）异常</a></li>
<li>Effective Java（十）并发</li>
</ul>
<a id="more"></a>

<h1 id="Item-1-使用静态工厂方法替代构造器"><a href="#Item-1-使用静态工厂方法替代构造器" class="headerlink" title="Item 1 使用静态工厂方法替代构造器"></a>Item 1 使用静态工厂方法替代构造器</h1><p>我们平时编写一个类的构造方法，然后用 new 去获取一个对象。</p>
<pre><code class="java">public class Student {
    String name;
    String age;

    Student(String name, String age){
        this.name = name;
        this.age = age;
    }
}

// client
Student jerry = new Student(&quot;jerry&quot;, 18);</code></pre>
<p>有时候我们还可以把构造器私有化，禁止 new，取而代之的是用一个静态方法 newInstance 来获取对象：</p>
<pre><code class="java">public class Student {
    String name;
    int age;

    private Student(String name, int age){
        this.name = name;
        this.age = age;
    }

    public static Student newInstance(String name, int age) {
        return new Student(name, age);
    }
}

// client
Student jerry = Student.newInstance(&quot;jerry&quot;, 18);</code></pre>
<p>这么做的好处有五个：</p>
<ol>
<li>有名字，构造方法有多个时容易搞混，静态工厂方法就不会；</li>
<li><strong>静态工厂方法不要求每次都返回一个新对象，可以用来做单例（singleton）和不可实例化保证；</strong></li>
<li>静态工厂方法可以返回一个对象的子类作为返回类型，而构造器不行，如 java.util.Collections；</li>
<li>静态工厂方法返回对象的类可以根据输入参数的不同而不同；</li>
<li>在编写包含该方法的类时，返回的对象的类不需要存在；</li>
</ol>
<p>使用静态工厂方法，主要的不足是，没有 public 或 protected 构造器，因此也无法被子类化。但从另一个角度来说，这也是优点，因为这样做鼓励程序员 <strong>多用组合，而不是继承</strong>，这是好的习惯。第二个不足是程序员可能比较难找到他们，以下是静态工厂方法常用的名字：</p>
<ul>
<li>from</li>
<li>of</li>
<li>valueOf</li>
<li>instance / getInstance</li>
<li>create / newInstance</li>
<li>getType</li>
<li>newType</li>
<li>type</li>
</ul>
<p>例如 jdk 里，获取 Boolean 对象：</p>
<pre><code class="java">public static Boolean valueOf(boolean b){
  return b ? Boolean.TRUE : Boolean.FALSE;
}</code></pre>
<hr>
<!-- more -->


<h1 id="Item-2-当构造器参数过多，考虑使用-Builder-模式"><a href="#Item-2-当构造器参数过多，考虑使用-Builder-模式" class="headerlink" title="Item 2 当构造器参数过多，考虑使用 Builder 模式"></a>Item 2 当构造器参数过多，考虑使用 Builder 模式</h1><p>这里的 Builder 模式不是指设计模式。假设你要组装一台电脑，有品牌、价格、CPU、是否防水、屏幕尺寸等参数，有些是必选的，有些是可选的，如果用构造器，看起来会像是这样：</p>
<pre><code class="java">public class Computer {
  private String brand;        // required
  private double price;        // required
  private int cpuGeneration;   // optional
  private boolean isWaterproof;// optional
  private int screenSize;      // optional

  Computer(String brand, double price){
    // something here
  }

  Computer(String brand, double price, int cpuGeneration){
    // something here
  }

  Computer(String brand, double price, int cpuGeneration, boolean isWaterproof){
    // something here
  }

  // ...

}</code></pre>
<p>你会发现，你要写好多好多不同的构造方法，而且还容易搞混。</p>
<p>最好使用内部 builder 类，在调用方根据需要进行组合，如下：</p>
<pre><code class="java">public class Computer {
    private String brand;        // required
    private double price;        // required
    private int cpuGeneration;   // optional
    private boolean isWaterproof;// optional
    private int screenSize;      // optional

    public static class Builder{
        private String brand;
        private double price;

        // Optional parameters - initialized to default values
        private int cpuGeneration = 3;
        private boolean isWaterproof = false;
        private int screenSize = 12;

        // constructor
        public Builder(String brand, double price) {
            this.brand = brand;
            this.price = price;
        }

        public Builder cpuGeneration(int value){
            cpuGeneration = value;
            return this;
        }

        public Builder isWaterproof(boolean value){
            isWaterproof = value;
            return this;
        }

        public Builder screenSize(int value){
            screenSize = value;
            return this;
        }

        public Computer build(){
            return new Computer(this);
        }
    }

    private Computer(Builder builder) {
        this.brand = builder.brand;
        this.price = builder.price;
        this.cpuGeneration = builder.cpuGeneration;
        this.isWaterproof = builder.isWaterproof;
        this.screenSize = builder.screenSize;
    }
}</code></pre>
<p>调用方：</p>
<pre><code class="java">public static void main(String[] args) {

    Computer computer = new Computer.Builder(&quot;MicroSoft&quot;, 6500.00)
            .cpuGeneration(7)
            .isWaterproof(false)
            .screenSize(24)
            .build();

    System.out.println(computer.toString());

}</code></pre>
<hr>
<h1 id="Item-3-使用私有构造器或枚举实现单例（Singleton）"><a href="#Item-3-使用私有构造器或枚举实现单例（Singleton）" class="headerlink" title="Item 3 使用私有构造器或枚举实现单例（Singleton）"></a>Item 3 使用私有构造器或枚举实现单例（Singleton）</h1><blockquote>
<p>注意: 不适用于多线程情况。</p>
</blockquote>
<p>单例用于一个类只允许一个实例对象的情况，通常有两种方法实现单例：<strong>公有域</strong> 和 <strong>公有静态方法</strong>。两种方式都是通过 <strong>私有构造器 + 公开静态成员</strong> 来实现的。</p>
<p>第一种方法：公有域，客户端通过 <code>Elvis.INSTANCE</code> 来获取唯一对象。</p>
<pre><code class="java">// Singleton with public final field
public class Elvis {
    public static final Elvis INSTANCE = new Elvis();
    private Elvis() { ... }
}</code></pre>
<p>第二种方法：公有静态工厂方法。</p>
<pre><code class="java">// Singleton with static factory
public class Elvis {
    private static final Elvis INSTANCE = new Elvis();
    private Elvis() { ... }
    public static Elvis getInstance() { return INSTANCE; }
}</code></pre>
<p>需要注意的是，有特权的客户端可以通过反射<code>AccessibleObject.setAccessible</code>的方式来调用私有构造方法。如果需要避免这个潜在的问题，可以修改构造函数，使其在请求创建第二个实例时抛出异常。</p>
<p>当需要序列化单例类对象时，仅仅用 <code>implements Serializable</code> 是不够的，因为每一次反序列化都会创建一个新的实例，解决办法是声明所有成员为 <code>transient</code>，然后用以下方法来返回实例。</p>
<pre><code class="java">// readResolve method to preserve singleton property
private Object readResolve() {
     // Return the one true Elvis and let the garbage collector
     // take care of the Elvis impersonator.
    return INSTANCE;
}</code></pre>
<p>最后还有一种用枚举实现单例的方式：</p>
<pre><code class="java">// Enum singleton - the preferred approach
public enum Elvis {
    INSTANCE;

    public void leaveTheBuilding() { ... }
}</code></pre>
<p>用这种方式无需担心序列化问题和反射攻击，但是如果单例类需要继承除 enum 外的其他父类，就不能使用这种方法。</p>
<hr>
<h1 id="Item-4-使用私有构造器实现不可实例化（Noninstantiable）"><a href="#Item-4-使用私有构造器实现不可实例化（Noninstantiable）" class="headerlink" title="Item 4 使用私有构造器实现不可实例化（Noninstantiable）"></a>Item 4 使用私有构造器实现不可实例化（Noninstantiable）</h1><p>有些类（如工具类）只包含静态域和静态方法，为了避免被误用，可以将其构造器设置为私有，从而不可实例化。</p>
<pre><code class="java">// Noninstantiable utility class
public class UtilityClass {
    // Suppress default constructor for noninstantiability
    private UtilityClass() {
        throw new AssertionError();
    }
    ... // Remainder omitted
}</code></pre>
<p>为什么不用抽象类来实现不可实例化呢？因为抽象类可以被继承，其子类可以被实例化，并且会误导用户认为该类是为继承而设计的。</p>
<hr>
<h1 id="Item-5-使用依赖注入，而不是硬编码所需资源"><a href="#Item-5-使用依赖注入，而不是硬编码所需资源" class="headerlink" title="Item 5 使用依赖注入，而不是硬编码所需资源"></a>Item 5 使用依赖注入，而不是硬编码所需资源</h1><p>有些工具类或单例对象，依赖于一些底层资源。如单词拼写检查器，依赖于字典。</p>
<pre><code class="java">// 静态工具类
// Inappropriate use of static utility - inflexible &amp; untestable!
public class SpellChecker {
    // 依赖直接生成
    private static final Lexicon dictionary = ...;

    private SpellChecker() {} // Noninstantiable

    public static boolean isValid(String word) { ... }
    public static List&lt;String&gt; suggestions(String typo) { ... }
}

// 单例对象
// Inappropriate use of singleton - inflexible &amp; untestable!
public class SpellChecker {
    // 依赖直接生成
    private final Lexicon dictionary = ...;

    private SpellChecker(...) {}
    public static INSTANCE = new SpellChecker(...);

    public boolean isValid(String word) { ... }
    public List&lt;String&gt; suggestions(String typo) { ... }
}</code></pre>
<p>然而，不同语言的单词拼写检查器，依赖于不同的字典，因此在 SpellChecker 直接依赖 dictionary，既不够灵活，又不便于测试（测试依赖其他字典时需要修改代码）。也就是说，<strong>静态工具类和单例类都不适合直接引用底层资源</strong>。</p>
<p>解决办法是 <strong>依赖注入（Dependency injection）</strong>。将 dictionary 依赖通过构造器，或静态工厂方法，或 item 2 中的 builder 传入 SpellChecker，从而实现解耦。</p>
<pre><code class="java">// Dependency injection provides flexibility and testability
public class SpellChecker {
    private final Lexicon dictionary;

    // 依赖由构造器传入
    public SpellChecker(Lexicon dictionary) {
        this.dictionary = Objects.requireNonNull(dictionary);
    }

    public boolean isValid(String word) { ... }
    public List&lt;String&gt; suggestions(String typo) { ... }
}</code></pre>
<p>一个更好的实践建议是，将资源工厂传递给构造器，再让工厂造资源。这也是设计模式中 <strong>工厂方法模式（Factory Method pattern）</strong> 的体现。Java 8 中引入的 <code>Supplier&lt;T&gt;</code> 接口非常适合代表工厂。</p>
<p>尽管依赖注入提高了灵活性和可测试性，但在大型项目中会让依赖变得十分混乱。使用依赖注入框架（如 Dagger、Guice  或 Spring）可以消除这些混乱。</p>
<hr>
<h1 id="Item-6-避免创建不必要的对象"><a href="#Item-6-避免创建不必要的对象" class="headerlink" title="Item 6 避免创建不必要的对象"></a>Item 6 避免创建不必要的对象</h1><h2 id="重用不可变对象"><a href="#重用不可变对象" class="headerlink" title="重用不可变对象"></a>重用不可变对象</h2><p>更多的时候，我们尽量要重用一个对象，而不是创建一个新的相同功能的对象，以节省资源。如果对象是不可变的（immutable, item 17），它就总是可以被重用。</p>
<p>一个反面例子：</p>
<pre><code class="java">String s = new String(&quot;bikini&quot;);  // DON&#39;T DO THIS!</code></pre>
<p>用 new 构造一个 String 时，其参数本身就是一个String，这样白白创建了一个 bikini 对象。正确的做法应该像下面这样，使用单个 String 实例，而不是每次执行时创建一个新实例。此外，它可以保证对象运行在同一虚拟机上的任何其他代码重用。</p>
<pre><code class="java">String s = &quot;bikini&quot;; // DO THIS !</code></pre>
<h2 id="使用静态工厂方法避免创建不需要的对象"><a href="#使用静态工厂方法避免创建不需要的对象" class="headerlink" title="使用静态工厂方法避免创建不需要的对象"></a>使用静态工厂方法避免创建不需要的对象</h2><p>使用静态工厂方法（static factory methods, item 1），可以避免创建不需要的对象。构造方法每次调用时都必须创建一个新对象，而工厂方法则不会。</p>
<h2 id="缓存（预编译）实例"><a href="#缓存（预编译）实例" class="headerlink" title="缓存（预编译）实例"></a>缓存（预编译）实例</h2><p>有些对象的创建很“昂贵”，例如检查一个字符串是否是一个有效的罗马数字：</p>
<pre><code class="java">// Performance can be greatly improved!
static boolean isRomanNumeral(String s) {
    return s.matches(&quot;^(?=.)M*(C[MD]|D?C{0,3})&quot;
            + &quot;(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})$&quot;);
}</code></pre>
<p>我们发现，每次调用都要去匹配一次。<code>s.matches</code>在内部为正则表达式创建一个 Pattern 实例，并且只使用它一次，之后就可能被垃圾回收。然而，创建 Pattern 实例是昂贵的。解决方法是，将正则表达式显式编译为一个 Pattern 实例（不可变），缓存它，并在 isRomanNumeral 方法的每个调用中重复使用相同的实例：</p>
<pre><code class="java">// Reusing expensive object for improved performance
public class RomanNumerals {
    private static final Pattern ROMAN = Pattern.compile(
            &quot;^(?=.)M*(C[MD]|D?C{0,3})&quot;
            + &quot;(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})$&quot;);

    static boolean isRomanNumeral(String s) {
        return ROMAN.matcher(s).matches();
    }
}</code></pre>
<h2 id="自动装箱导致的创建不必要对象"><a href="#自动装箱导致的创建不必要对象" class="headerlink" title="自动装箱导致的创建不必要对象"></a>自动装箱导致的创建不必要对象</h2><p>注意自动装箱导致的创建不必要对象。如下面的代码，用 <code>Long</code> 会比 <code>long</code> 额外创建 2^31个不必要的 Long 实例。所以，优先使用基本类型而不是装箱的基本类型，也要注意无意识的自动装箱。</p>
<pre><code class="java">// Hideously slow! Can you spot the object creation?
private static long sum() {
    Long sum = 0L;
    for (long i = 0; i &lt;= Integer.MAX_VALUE; i++)
        sum += i;
    return sum;
}</code></pre>
<p>最后，避免创建不必要的对象这并不是说对象创建是昂贵的，应该避免创建对象。现代JVM可以很轻松应对廉价的对象，但是像数据库连接这样的重量级对象，就应该考虑重用的问题。</p>
<hr>
<h1 id="Item-7-消除过期的对象引用"><a href="#Item-7-消除过期的对象引用" class="headerlink" title="Item 7 消除过期的对象引用"></a>Item 7 消除过期的对象引用</h1><p>Java自带垃圾收集机制，但有时候得手动清除不需要的引用。</p>
<p>在一个栈的实现中，弹栈时我们返回 pop 之后的栈顶元素，但刚刚被弹出去的元素，其实已经不再被需要了，然而它的引用还在，垃圾收集器不会回收它。所以这个栈存在「内存泄漏」。</p>
<pre><code class="java">public Object pop() {
    if (size == 0)
        throw new EmptyStackException();
    return elements[--size];
}</code></pre>
<p>如下图所示，一个数组实现的栈，尽管 <code>s[5]</code> 已经被 pop 出去，但垃圾回收器不知道，它会认为 s[0] - s[7] 都是有用的。</p>
<p><img src="../../../../images/Java/obsolete_ref.png" alt=""></p>
<p>解决办法很简单，对弹出去的元素置为 null 即可：</p>
<pre><code class="java">public Object pop() {
    if (size == 0)
        throw new EmptyStackException();
    Object result = elements[--size];
    elements[size] = null; // Eliminate obsolete reference
    return result;
}</code></pre>
<blockquote>
<p>请注意，清空对象引用应该是例外而不是规范。当一个类自己管理内存时，程序员才应该警惕内存泄漏问题。</p>
</blockquote>
<hr>
<h1 id="Item-8-避免使用-Finalizer-和-Cleaner-机制"><a href="#Item-8-避免使用-Finalizer-和-Cleaner-机制" class="headerlink" title="Item 8 避免使用 Finalizer 和 Cleaner 机制"></a>Item 8 避免使用 Finalizer 和 Cleaner 机制</h1><p> Finalizer 被设计用来当垃圾回收时关闭一些特殊的资源，可能有点像 C++ 的析构函数，但它并不稳定，因为我们无法确定什么时候垃圾回收。从 Java 9 开始，Finalizer 已被弃用，但仍被 Java 类库所使用。 Java 9 中 Cleaner 机制代替了 Finalizer 机制。但是 Cleaner 仍然是不可预测的。一般不要轻易尝试 Finalizer 和 Cleaner 。</p>
<p> 需要关闭一般资源时，请使用 <code>try-with-resource</code>。只有在使用 JNI(Java Native Interface) 调用non-Java程序（C或C++）时，才使用 finalize() 来回收这部分的内存。</p>
<hr>
<h1 id="Item-9-使用-try-with-resource-代替-try-finally"><a href="#Item-9-使用-try-with-resource-代替-try-finally" class="headerlink" title="Item 9 使用 try-with-resource 代替 try-finally"></a>Item 9 使用 try-with-resource 代替 try-finally</h1><p>像 <code>InputStream</code>，<code>OutputStream</code> 和 <code>java.sql.Connection</code> 这些资源时需要关闭的，通常我们用 <code>try-finally</code> 来关闭，但如果有多个资源需要关闭，情况会变得很糟糕：</p>
<pre><code class="java">// try-finally is ugly when used with more than one resource!
static void copy(String src, String dst) throws IOException {
    InputStream in = new FileInputStream(src);
    try {
        OutputStream out = new FileOutputStream(dst);
        try {
            byte[] buf = new byte[BUFFER_SIZE];
            int n;
            while ((n = in.read(buf)) &gt;= 0)
                out.write(buf, 0, n);
        } finally {
            out.close();
        }
    } finally {
        in.close();
    }
}</code></pre>
<p>内层的try块喝finally块都可能抛出异常，然而外层的 finally 块会吃掉内层的异常，导致在异常堆栈跟踪中没有第一个异常的记录，这会让调试变得非常复杂。</p>
<p>因此，在 Java 7 引入了 try-with-resources 语句，只要资源实现了 <code>AutoCloseable</code>接口就可以使用。当前， Java 类库和第三方类库中的许多类和接口现在都实现或继承了 <code>AutoCloseable</code>，所以无需担心。</p>
<pre><code class="java">// try-with-resources on multiple resources - short and sweet
static void copy(String src, String dst) throws IOException {
    try (InputStream   in = new FileInputStream(src);
         OutputStream out = new FileOutputStream(dst)) {
        byte[] buf = new byte[BUFFER_SIZE];
        int n;
        while ((n = in.read(buf)) &gt;= 0)
            out.write(buf, 0, n);
    }
}</code></pre>

        </div>
        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/Java/" rel="tag">Java</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/post/f754c291.html">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">Effective Java（二）对象通用的方法</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/post/5d95362f.html">
                <span class="level-item">Crash Course Computer Science（31-40）</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>


</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="" src="/images/avatar.png" alt="Jerry Sheh">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        Jerry Sheh
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        车顶上绑着飞机发动机
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Shenzhen</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <a href="/archives">
                        <p class="title has-text-weight-normal">
                            156
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <a href="/categories">
                        <p class="title has-text-weight-normal">
                            18
                        </p>
                    </a>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <a href="/tags">
                        <p class="title has-text-weight-normal">
                            35
                        </p>
                    </a>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="mailto:jerrysheh@gmail.com" target="_blank" rel="noopener">
                联系我</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Github" href="https://github.com/Jerrysheh">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="email" href="mailto:jerrysheh@gmail.com">
                
                <i class="fa fa-envelope"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" rel="noopener"
                title="Zhihu" href="https://www.zhihu.com/people/jerrysheh">
                
                <i class="fab fa-zhihu"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        

    <div class="card widget" id="toc">
        <div class="card-content">
            <div class="menu">
                <h3 class="menu-label">
                    目录
                </h3>
                <ul class="menu-list"><li>
        <a class="is-flex" href="#Item-1-使用静态工厂方法替代构造器">
        <span class="has-mr-6">1</span>
        <span>Item 1 使用静态工厂方法替代构造器</span>
        </a></li><li>
        <a class="is-flex" href="#Item-2-当构造器参数过多，考虑使用-Builder-模式">
        <span class="has-mr-6">2</span>
        <span>Item 2 当构造器参数过多，考虑使用 Builder 模式</span>
        </a></li><li>
        <a class="is-flex" href="#Item-3-使用私有构造器或枚举实现单例（Singleton）">
        <span class="has-mr-6">3</span>
        <span>Item 3 使用私有构造器或枚举实现单例（Singleton）</span>
        </a></li><li>
        <a class="is-flex" href="#Item-4-使用私有构造器实现不可实例化（Noninstantiable）">
        <span class="has-mr-6">4</span>
        <span>Item 4 使用私有构造器实现不可实例化（Noninstantiable）</span>
        </a></li><li>
        <a class="is-flex" href="#Item-5-使用依赖注入，而不是硬编码所需资源">
        <span class="has-mr-6">5</span>
        <span>Item 5 使用依赖注入，而不是硬编码所需资源</span>
        </a></li><li>
        <a class="is-flex" href="#Item-6-避免创建不必要的对象">
        <span class="has-mr-6">6</span>
        <span>Item 6 避免创建不必要的对象</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#重用不可变对象">
        <span class="has-mr-6">6.1</span>
        <span>重用不可变对象</span>
        </a></li><li>
        <a class="is-flex" href="#使用静态工厂方法避免创建不需要的对象">
        <span class="has-mr-6">6.2</span>
        <span>使用静态工厂方法避免创建不需要的对象</span>
        </a></li><li>
        <a class="is-flex" href="#缓存（预编译）实例">
        <span class="has-mr-6">6.3</span>
        <span>缓存（预编译）实例</span>
        </a></li><li>
        <a class="is-flex" href="#自动装箱导致的创建不必要对象">
        <span class="has-mr-6">6.4</span>
        <span>自动装箱导致的创建不必要对象</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#Item-7-消除过期的对象引用">
        <span class="has-mr-6">7</span>
        <span>Item 7 消除过期的对象引用</span>
        </a></li><li>
        <a class="is-flex" href="#Item-8-避免使用-Finalizer-和-Cleaner-机制">
        <span class="has-mr-6">8</span>
        <span>Item 8 避免使用 Finalizer 和 Cleaner 机制</span>
        </a></li><li>
        <a class="is-flex" href="#Item-9-使用-try-with-resource-代替-try-finally">
        <span class="has-mr-6">9</span>
        <span>Item 9 使用 try-with-resource 代替 try-finally</span>
        </a></li></ul>
            </div>
        </div>
    </div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/Android/">
            <span class="level-start">
                <span class="level-item">Android</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">11</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/C-C/">
            <span class="level-start">
                <span class="level-item">C/C++</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Effective-Java/">
            <span class="level-start">
                <span class="level-item">Effective Java</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">9</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Golang/">
            <span class="level-start">
                <span class="level-item">Golang</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Java/">
            <span class="level-start">
                <span class="level-item">Java</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">23</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Java-Web/">
            <span class="level-start">
                <span class="level-item">Java Web</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">19</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/">
            <span class="level-start">
                <span class="level-item">Java虚拟机</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/linux/">
            <span class="level-start">
                <span class="level-item">linux</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">12</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">
            <span class="level-start">
                <span class="level-item">大数据</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">12</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">
            <span class="level-start">
                <span class="level-item">微服务</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
            <span class="level-start">
                <span class="level-item">操作系统</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">7</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">
            <span class="level-start">
                <span class="level-item">数据库</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/">
            <span class="level-start">
                <span class="level-item">数据结构和算法</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">9</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E7%94%9F%E6%B4%BB/">
            <span class="level-start">
                <span class="level-item">生活</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">10</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/">
            <span class="level-start">
                <span class="level-item">计算机</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">12</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">
            <span class="level-start">
                <span class="level-item">计算机网络</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">8</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
            <span class="level-start">
                <span class="level-item">设计模式</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/post/4e34dae4.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Effective Java（九）异常">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-29T11:50:38.000Z">2019-11-29</time></div>
                    <a href="/post/4e34dae4.html" class="title has-link-black-ter is-size-6 has-text-weight-normal">Effective Java（九）异常</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Effective-Java/">Effective Java</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/post/a0972c39.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Spring（九）SpringBoot 双数据源">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-27T10:50:18.000Z">2019-11-27</time></div>
                    <a href="/post/a0972c39.html" class="title has-link-black-ter is-size-6 has-text-weight-normal">Spring（九）SpringBoot 双数据源</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Java-Web/">Java Web</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/post/7d5810ff.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Effective Java（八）General Programming">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-25T13:55:19.000Z">2019-11-25</time></div>
                    <a href="/post/7d5810ff.html" class="title has-link-black-ter is-size-6 has-text-weight-normal">Effective Java（八）General Programming</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Effective-Java/">Effective Java</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/post/387fb533.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Effective Java（七）方法">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-22T13:39:53.000Z">2019-11-22</time></div>
                    <a href="/post/387fb533.html" class="title has-link-black-ter is-size-6 has-text-weight-normal">Effective Java（七）方法</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Effective-Java/">Effective Java</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/post/cc85a16e.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Effective Java（六）Lambdas and Streams">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-19T14:39:14.000Z">2019-11-19</time></div>
                    <a href="/post/cc85a16e.html" class="title has-link-black-ter is-size-6 has-text-weight-normal">Effective Java（六）Lambdas and Streams</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Effective-Java/">Effective Java</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            推荐链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://www.xaprb.com/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Baron Schwartz</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.xaprb.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.wmyskxz.com/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">我没有三颗心脏</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.wmyskxz.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/post/4e34dae4.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Effective Java（九）异常">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-29T11:50:38.000Z">2019-11-29</time></div>
                    <a href="/post/4e34dae4.html" class="title has-link-black-ter is-size-6 has-text-weight-normal">Effective Java（九）异常</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Effective-Java/">Effective Java</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/post/a0972c39.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Spring（九）SpringBoot 双数据源">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-27T10:50:18.000Z">2019-11-27</time></div>
                    <a href="/post/a0972c39.html" class="title has-link-black-ter is-size-6 has-text-weight-normal">Spring（九）SpringBoot 双数据源</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Java-Web/">Java Web</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/post/7d5810ff.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Effective Java（八）General Programming">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-25T13:55:19.000Z">2019-11-25</time></div>
                    <a href="/post/7d5810ff.html" class="title has-link-black-ter is-size-6 has-text-weight-normal">Effective Java（八）General Programming</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Effective-Java/">Effective Java</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/post/387fb533.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Effective Java（七）方法">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-22T13:39:53.000Z">2019-11-22</time></div>
                    <a href="/post/387fb533.html" class="title has-link-black-ter is-size-6 has-text-weight-normal">Effective Java（七）方法</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Effective-Java/">Effective Java</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/post/cc85a16e.html" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Effective Java（六）Lambdas and Streams">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-19T14:39:14.000Z">2019-11-19</time></div>
                    <a href="/post/cc85a16e.html" class="title has-link-black-ter is-size-6 has-text-weight-normal">Effective Java（六）Lambdas and Streams</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Effective-Java/">Effective Java</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            推荐链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://www.xaprb.com/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">Baron Schwartz</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.xaprb.com</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://www.wmyskxz.com/" target="_blank" rel="noopener">
                    <span class="level-left">
                        <span class="level-item">我没有三颗心脏</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">www.wmyskxz.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.png" alt="Effective Java（一）创建和销毁对象" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 Jerry Sheh&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


<script>
var IcarusThemeSettings = {
    site: {
        url: 'https://jerrysheh.me',
        external_link: {"enable":true,"exclude":[]}
    },
    article: {
        highlight: {
            clipboard: true,
            fold: 'folded'
        }
    }
};
</script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>





<script src="/js/animation.js"></script>



<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>



<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>


<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>














<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>